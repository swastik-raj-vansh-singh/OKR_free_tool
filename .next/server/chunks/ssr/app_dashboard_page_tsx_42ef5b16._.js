module.exports=[20731,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(578),e=a.i(50944),f=a.i(40695),g=a.i(5522),h=a.i(17171),i=a.i(46893),j=a.i(3130),k=a.i(87682),l=a.i(54161),m=a.i(50104),n=a.i(30553),o="Progress",[p,q]=(0,m.createContextScope)(o),[r,s]=p(o),t=c.forwardRef((a,c)=>{var d,e;let{__scopeProgress:f,value:g=null,max:h,getValueLabel:i=w,...j}=a;(h||0===h)&&!z(h)&&console.error((d=`${h}`,`Invalid prop \`max\` of value \`${d}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let k=z(h)?h:100;null===g||A(g,k)||console.error((e=`${g}`,`Invalid prop \`value\` of value \`${e}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let l=A(g,k)?g:null,m=y(l)?i(l,k):void 0;return(0,b.jsx)(r,{scope:f,value:l,max:k,children:(0,b.jsx)(n.Primitive.div,{"aria-valuemax":k,"aria-valuemin":0,"aria-valuenow":y(l)?l:void 0,"aria-valuetext":m,role:"progressbar","data-state":x(l,k),"data-value":l??void 0,"data-max":k,...j,ref:c})})});t.displayName=o;var u="ProgressIndicator",v=c.forwardRef((a,c)=>{let{__scopeProgress:d,...e}=a,f=s(u,d);return(0,b.jsx)(n.Primitive.div,{"data-state":x(f.value,f.max),"data-value":f.value??void 0,"data-max":f.max,...e,ref:c})});function w(a,b){return`${Math.round(a/b*100)}%`}function x(a,b){return null==a?"indeterminate":a===b?"complete":"loading"}function y(a){return"number"==typeof a}function z(a){return y(a)&&!isNaN(a)&&a>0}function A(a,b){return y(a)&&!isNaN(a)&&a<=b&&a>=0}v.displayName=u;var B=a.i(97895);function C({className:a,value:c,...d}){return(0,b.jsx)(t,{"data-slot":"progress",className:(0,B.cn)("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",a),...d,children:(0,b.jsx)(v,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:`translateX(-${100-(c||0)}%)`}})})}var D=a.i(65733),E=a.i(21958),F=a.i(70106);let G=(0,F.default)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),H=(0,F.default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),I=(0,F.default)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]);var J=a.i(69520),K=a.i(41675),L=a.i(5151);let M=(0,F.default)("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),N=(0,F.default)("Link2",[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]]);var O=a.i(84505);let P=(0,F.default)("Bot",[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]]),Q=(0,F.default)("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);var R=a.i(210),S=a.i(96221),T=a.i(16201),U=a.i(4720),V=a.i(7353),W=a.i(54074),X=a.i(26251),Y=a.i(76504);let Z=()=>Math.random().toString(36).substring(2,9);function $(){let a=(0,e.useRouter)(),{currentUser:m,leaderOKRs:n,setLeaderOKRs:o,companyProfile:p,weeklyUpdates:q,addWeeklyUpdate:r,updateSchedules:s,addUpdateSchedule:t,setToastMessage:u,setCurrentScreen:v,isLoading:w,setIsLoading:x,invites:y,shareableSummary:z,planningPeriod:A}=(0,d.useOKR)(),[B,F]=(0,c.useState)(!1),[$,_]=(0,c.useState)(!1),[aa,ab]=(0,c.useState)(!1),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)(null),[ag,ah]=(0,c.useState)({actualValue:"",notes:"",evidenceLink:""}),[ai,aj]=(0,c.useState)({name:"Weekly OKR Update",cadence:"weekly",dayOfWeek:"monday",timeOfDay:"09:00"}),[ak,al]=(0,c.useState)({agentName:"",dataSource:""}),am=a=>{let b=a.keyResults.length;return 0===b?0:Math.round(a.keyResults.reduce((a,b)=>a+Math.min(b.actual/b.target*100,100),0)/b)},an=async()=>{if(!ae||!ag.actualValue)return;x(!0),await new Promise(a=>setTimeout(a,1e3));let a={updateId:Z(),planId:"plan-1",objectiveId:ae.objectiveId,krId:ae.krId,actualValue:Number(ag.actualValue),notes:ag.notes,evidenceLink:ag.evidenceLink,createdAt:new Date().toISOString()};o(n.map(a=>a.objectiveId===ae.objectiveId?{...a,keyResults:a.keyResults.map(a=>a.krId===ae.krId?{...a,actual:Number(ag.actualValue),progress:Math.min(Math.round(Number(ag.actualValue)/a.target*100),100)}:a)}:a)),r(a),x(!1),F(!1),u("Update saved.")},ao=async()=>{if(!m?.userId)return void u("User not authenticated. Please log in.");x(!0);try{let a=await fetch("/api/user/reminder-settings",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:m.userId,reminder_enabled:!0,reminder_frequency:ai.cadence,reminder_day:ai.dayOfWeek,reminder_time:`${ai.timeOfDay}:00`})});if(!a.ok)throw Error("Failed to save reminder settings");await a.json();let b={scheduleId:Z(),planId:"plan-1",name:ai.name,cadence:ai.cadence,dayOfWeek:ai.dayOfWeek,timeOfDay:ai.timeOfDay,participants:[],nextRunAt:new Date(Date.now()+6048e5).toISOString()};t(b),x(!1),_(!1),u(`Update schedule active — next run ${new Date(b.nextRunAt).toLocaleDateString()}`)}catch(a){console.error("Error creating schedule:",a),x(!1),u("Failed to create schedule. Please try again.")}},ap=async()=>{ak.agentName&&ak.dataSource&&(x(!0),await new Promise(a=>setTimeout(a,2e3)),x(!1),ab(!1),u("Agent provisioning started. We'll notify you when it's ready."))},aq=n.length>0?Math.round(n.reduce((a,b)=>a+am(b),0)/n.length):0;return(0,b.jsxs)("div",{className:"max-w-5xl mx-auto space-y-8",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-2xl font-bold",children:"Plan vs. Actuals Dashboard"}),(0,b.jsxs)("p",{className:"text-muted-foreground",children:[p?.name," — ",n.length," Objectives"]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>a.push("/edit"),children:[(0,b.jsx)(R.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Back to Edit"]})})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50",children:(0,b.jsxs)(j.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Overall Progress"}),(0,b.jsxs)("p",{className:"text-3xl font-bold",children:[aq,"%"]})]}),(0,b.jsx)("div",{className:"p-3 rounded-full bg-primary/10",children:(0,b.jsx)(G,{className:"w-6 h-6 text-primary"})})]}),(0,b.jsx)(C,{value:aq,className:"mt-4"})]})}),(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50",children:(0,b.jsxs)(j.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Team Members"}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:y.length||0})]}),(0,b.jsx)("div",{className:"p-3 rounded-full bg-accent/10",children:(0,b.jsx)(T.CheckCircle,{className:"w-6 h-6 text-accent"})})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-4",children:[y.filter(a=>"accepted"===a.status).length," accepted invites"]})]})}),(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50",children:(0,b.jsxs)(j.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Updates This Week"}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:q.length})]}),(0,b.jsx)("div",{className:"p-3 rounded-full bg-chart-4/10",children:(0,b.jsx)(J.RefreshCw,{className:"w-6 h-6 text-chart-4"})})]}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-4",children:s.length>0?`Next scheduled: ${s[0].dayOfWeek}`:"No schedule set"})]})})]}),(0,b.jsxs)(E.Tabs,{defaultValue:"objectives",className:"w-full",children:[(0,b.jsxs)(E.TabsList,{children:[(0,b.jsx)(E.TabsTrigger,{value:"objectives",children:"Objectives"}),(0,b.jsx)(E.TabsTrigger,{value:"activity",children:"Activity Feed"})]}),(0,b.jsx)(E.TabsContent,{value:"objectives",className:"space-y-4 mt-4",children:n.map((a,c)=>(0,b.jsxs)(j.Card,{className:"border-border/50 bg-card/50",children:[(0,b.jsx)(j.CardHeader,{className:"pb-2",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(l.Badge,{variant:"secondary",children:["O",c+1]}),(0,b.jsx)(j.CardTitle,{className:"text-lg",children:a.title})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[am(a),"%"]}),(0,b.jsx)(C,{value:am(a),className:"w-24"})]})]})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:a.keyResults.map((c,d)=>{let e,g=(e=c.actual/c.target*100)>=70?"on-track":e>=40?"at-risk":"off-track",h=Math.round(c.actual/c.target*100);return(0,b.jsxs)("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-background/50 border border-border/50",children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground w-8",children:["KR",d+1]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm",children:c.text}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[c.actual," / ",c.target," ",c.unit]}),(0,b.jsx)(C,{value:h,className:"w-32 h-1.5"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["on-track"===g&&(0,b.jsxs)(l.Badge,{variant:"outline",className:"text-accent border-accent/30 gap-1",children:[(0,b.jsx)(G,{className:"w-3 h-3"}),"On track"]}),"at-risk"===g&&(0,b.jsxs)(l.Badge,{variant:"outline",className:"text-chart-4 border-chart-4/30 gap-1",children:[(0,b.jsx)(I,{className:"w-3 h-3"}),"At risk"]}),"off-track"===g&&(0,b.jsxs)(l.Badge,{variant:"outline",className:"text-destructive border-destructive/30 gap-1",children:[(0,b.jsx)(H,{className:"w-3 h-3"}),"Off track"]}),(0,b.jsx)(f.Button,{variant:"outline",size:"sm",onClick:()=>{var b;return b=a.objectiveId,void(af({objectiveId:b,krId:c.krId,text:c.text}),ah({actualValue:"",notes:"",evidenceLink:""}),F(!0))},children:"Update"})]})]},c.krId)})})})]},a.objectiveId))}),(0,b.jsx)(E.TabsContent,{value:"activity",className:"mt-4",children:(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50",children:(0,b.jsx)(j.CardContent,{className:"pt-6",children:q.length>0?(0,b.jsx)("div",{className:"space-y-4",children:q.map(a=>(0,b.jsxs)("div",{className:"flex gap-4 pb-4 border-b border-border last:border-0",children:[(0,b.jsx)("div",{className:"p-2 rounded-full bg-primary/10 h-fit",children:(0,b.jsx)(J.RefreshCw,{className:"w-4 h-4 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("p",{className:"text-sm",children:["Updated KR to ",(0,b.jsx)("span",{className:"font-medium",children:a.actualValue})]}),a.notes&&(0,b.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:a.notes}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:new Date(a.createdAt).toLocaleString()})]})]},a.updateId))}):(0,b.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,b.jsx)(J.RefreshCw,{className:"w-8 h-8 mx-auto mb-2 opacity-50"}),(0,b.jsx)("p",{children:"No updates yet. Start tracking progress by updating your key results."})]})})})})]}),(0,b.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>_(!0),children:[(0,b.jsx)(K.Calendar,{className:"w-4 h-4 mr-2"}),"Schedule Updates"]}),(0,b.jsxs)(f.Button,{variant:"outline",children:[(0,b.jsx)(L.Copy,{className:"w-4 h-4 mr-2"}),"Copy Weekly Update"]}),(0,b.jsxs)(f.Button,{variant:"outline",children:[(0,b.jsx)(M,{className:"w-4 h-4 mr-2"}),"Post to Slack"]}),(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>{let a=`${window.location.origin}/dashboard/shared/${Z()}`;navigator.clipboard.writeText(a),u("Dashboard link copied to clipboard!"),ad(!0)},children:[(0,b.jsx)(N,{className:"w-4 h-4 mr-2"}),"Share Dashboard Link"]}),(0,b.jsxs)(Y.DropdownMenu,{children:[(0,b.jsx)(Y.DropdownMenuTrigger,{asChild:!0,children:(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",className:"gap-2 border-primary/50 hover:border-primary hover:bg-primary/10 dark:border-primary/30 dark:hover:border-primary/50 dark:hover:bg-primary/20",children:[(0,b.jsx)(O.Download,{className:"w-4 h-4"}),"Export"]})}),(0,b.jsxs)(Y.DropdownMenuContent,{align:"end",className:"w-56",children:[(0,b.jsx)(Y.DropdownMenuLabel,{children:"Export Format"}),(0,b.jsx)(Y.DropdownMenuSeparator,{}),(0,b.jsxs)(Y.DropdownMenuItem,{onClick:()=>{let a=`# OKRs for ${p?.name||"Organization"}

`;a+=`**Planning Period:** ${A}
**Export Date:** ${new Date().toLocaleDateString()}

`,z?.text&&(a+=`## Strategic Summary

${z.text}

`),a+=`## Objectives and Key Results

`,n.forEach((b,c)=>{a+=`### O${c+1}: ${b.title}

`,b.description&&(a+=`${b.description}

`),a+=`**Key Results:**

`,b.keyResults.forEach((b,c)=>{a+=`- **KR${c+1}:** ${b.text} (Target: ${b.target} ${b.unit})
`}),a+="\n"});let b=new Blob([a],{type:"text/markdown"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`okrs-${p?.name||"export"}-${new Date().toISOString().split("T")[0]}.md`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),u("OKRs exported as Markdown")},children:[(0,b.jsx)(U.FileText,{className:"w-4 h-4 mr-2"}),"Markdown (.md)"]}),(0,b.jsxs)(Y.DropdownMenuItem,{onClick:()=>{let a="Objective Number,Objective Title,KR Number,Key Result,Target,Unit\n";n.forEach((b,c)=>{b.keyResults.forEach((d,e)=>{let f=[`O${c+1}`,`"${b.title.replace(/"/g,'""')}"`,`KR${e+1}`,`"${d.text.replace(/"/g,'""')}"`,d.target,d.unit].join(",");a+=f+"\n"})});let b=new Blob([a],{type:"text/csv"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`okrs-${p?.name||"export"}-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),u("OKRs exported as CSV")},children:[(0,b.jsx)(V.Table,{className:"w-4 h-4 mr-2"}),"CSV Spreadsheet (.csv)"]}),(0,b.jsxs)(Y.DropdownMenuItem,{onClick:()=>{let a=new Blob([JSON.stringify({company:p?.name,planningPeriod:A,exportDate:new Date().toISOString(),strategicSummary:z?.text,objectives:n.map((a,b)=>({objectiveNumber:b+1,title:a.title,description:a.description,keyResults:a.keyResults.map((a,b)=>({krNumber:b+1,text:a.text,target:a.target,unit:a.unit,actual:a.actual,progress:a.progress}))}))},null,2)],{type:"application/json"}),b=URL.createObjectURL(a),c=document.createElement("a");c.href=b,c.download=`okrs-${p?.name||"export"}-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(b),u("OKRs exported as JSON")},children:[(0,b.jsx)(W.Code,{className:"w-4 h-4 mr-2"}),"JSON Data (.json)"]}),(0,b.jsx)(Y.DropdownMenuSeparator,{}),(0,b.jsxs)(Y.DropdownMenuItem,{onClick:()=>{let a,b=new Blob([(a=`OKRs for ${p?.name||"Organization"}
Planning Period: ${A}
Export Date: ${new Date().toLocaleDateString()}

`,z?.text&&(a+=`Strategic Summary:
${z.text}

`),a+=`Objectives and Key Results:

`,n.forEach((b,c)=>{a+=`O${c+1}: ${b.title}
`,b.description&&(a+=`   ${b.description}
`),b.keyResults.forEach((b,c)=>{a+=`   KR${c+1}: ${b.text} (Target: ${b.target} ${b.unit})
`}),a+="\n"}),a)],{type:"text/plain"}),c=URL.createObjectURL(b),d=document.createElement("a");d.href=c,d.download=`okrs-${p?.name||"export"}-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),u("OKRs exported as text file (PDF generation coming soon)")},className:"text-muted-foreground",children:[(0,b.jsx)(X.FileDown,{className:"w-4 h-4 mr-2"}),"PDF Document (Coming Soon)"]})]})]}),(0,b.jsxs)(f.Button,{onClick:()=>ab(!0),className:"ml-auto bg-gradient-to-r from-primary to-accent text-primary-foreground",children:[(0,b.jsx)(P,{className:"w-4 h-4 mr-2"}),"Deploy Agent to Auto-Track"]})]}),(0,b.jsx)(D.Dialog,{open:B,onOpenChange:F,children:(0,b.jsxs)(D.DialogContent,{children:[(0,b.jsxs)(D.DialogHeader,{children:[(0,b.jsx)(D.DialogTitle,{children:"Update Progress"}),(0,b.jsx)(D.DialogDescription,{children:ae?.text})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Actual Value"}),(0,b.jsx)(g.Input,{type:"number",placeholder:"Enter current value",value:ag.actualValue,onChange:a=>ah({...ag,actualValue:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Notes"}),(0,b.jsx)(i.Textarea,{placeholder:"What progress was made?",value:ag.notes,onChange:a=>ah({...ag,notes:a.target.value}),rows:3})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Evidence Link (optional)"}),(0,b.jsx)(g.Input,{type:"url",placeholder:"https://...",value:ag.evidenceLink,onChange:a=>ah({...ag,evidenceLink:a.target.value})})]})]}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>F(!1),children:"Cancel"}),(0,b.jsxs)(f.Button,{onClick:an,disabled:w||!ag.actualValue,children:[w?(0,b.jsx)(S.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Save Update"]})]})]})}),(0,b.jsx)(D.Dialog,{open:$,onOpenChange:_,children:(0,b.jsxs)(D.DialogContent,{children:[(0,b.jsxs)(D.DialogHeader,{children:[(0,b.jsx)(D.DialogTitle,{children:"Schedule Updates"}),(0,b.jsx)(D.DialogDescription,{children:"Set up recurring reminders for your team to update progress."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Schedule Name"}),(0,b.jsx)(g.Input,{value:ai.name,onChange:a=>aj({...ai,name:a.target.value})})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Cadence"}),(0,b.jsxs)(k.Select,{value:ai.cadence,onValueChange:a=>aj({...ai,cadence:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"weekly",children:"Weekly"}),(0,b.jsx)(k.SelectItem,{value:"biweekly",children:"Bi-weekly"}),(0,b.jsx)(k.SelectItem,{value:"monthly",children:"Monthly"})]})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Day"}),(0,b.jsxs)(k.Select,{value:ai.dayOfWeek,onValueChange:a=>aj({...ai,dayOfWeek:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"monday",children:"Monday"}),(0,b.jsx)(k.SelectItem,{value:"tuesday",children:"Tuesday"}),(0,b.jsx)(k.SelectItem,{value:"wednesday",children:"Wednesday"}),(0,b.jsx)(k.SelectItem,{value:"thursday",children:"Thursday"}),(0,b.jsx)(k.SelectItem,{value:"friday",children:"Friday"})]})]})]})]})]}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>_(!1),children:"Cancel"}),(0,b.jsxs)(f.Button,{onClick:ao,disabled:w,children:[w?(0,b.jsx)(S.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}):null,"Create Schedule"]})]})]})}),(0,b.jsx)(D.Dialog,{open:aa,onOpenChange:ab,children:(0,b.jsxs)(D.DialogContent,{children:[(0,b.jsxs)(D.DialogHeader,{children:[(0,b.jsx)("div",{className:"mx-auto p-3 rounded-xl bg-gradient-to-br from-primary/20 to-accent/20 w-fit mb-4",children:(0,b.jsx)(P,{className:"w-8 h-8 text-primary"})}),(0,b.jsx)(D.DialogTitle,{className:"text-center",children:"Deploy Lamatic Agent"}),(0,b.jsx)(D.DialogDescription,{className:"text-center",children:"Automatically track KR progress by connecting to your data sources."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Agent Name"}),(0,b.jsx)(g.Input,{placeholder:"e.g., Revenue Tracker",value:ak.agentName,onChange:a=>al({...ak,agentName:a.target.value})})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Data Source"}),(0,b.jsxs)(k.Select,{value:ak.dataSource,onValueChange:a=>al({...ak,dataSource:a}),children:[(0,b.jsx)(k.SelectTrigger,{children:(0,b.jsx)(k.SelectValue,{placeholder:"Select a connector"})}),(0,b.jsxs)(k.SelectContent,{children:[(0,b.jsx)(k.SelectItem,{value:"google_analytics",children:"Google Analytics"}),(0,b.jsx)(k.SelectItem,{value:"hubspot",children:"HubSpot"}),(0,b.jsx)(k.SelectItem,{value:"salesforce",children:"Salesforce"}),(0,b.jsx)(k.SelectItem,{value:"slack",children:"Slack"}),(0,b.jsx)(k.SelectItem,{value:"snowflake",children:"Snowflake"})]})]})]}),(0,b.jsx)("div",{className:"p-4 rounded-lg bg-secondary/30 border border-border/50",children:(0,b.jsxs)("div",{className:"flex items-start gap-3",children:[(0,b.jsx)(Q,{className:"w-5 h-5 text-accent shrink-0 mt-0.5"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Powered by Lamatic"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Your agent will poll data every 15 minutes and automatically update your KR actuals."})]})]})})]}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>ab(!1),children:"Cancel"}),(0,b.jsxs)(f.Button,{onClick:ap,disabled:w||!ak.agentName||!ak.dataSource,className:"bg-gradient-to-r from-primary to-accent",children:[w?(0,b.jsx)(S.Loader2,{className:"w-4 h-4 mr-2 animate-spin"}):(0,b.jsx)(P,{className:"w-4 h-4 mr-2"}),"Deploy Agent"]})]})]})}),(0,b.jsx)(D.Dialog,{open:ac,onOpenChange:ad,children:(0,b.jsxs)(D.DialogContent,{children:[(0,b.jsxs)(D.DialogHeader,{children:[(0,b.jsx)("div",{className:"mx-auto p-3 rounded-full bg-primary/10 w-fit mb-4",children:(0,b.jsx)(N,{className:"w-8 h-8 text-primary"})}),(0,b.jsx)(D.DialogTitle,{className:"text-center",children:"Share Dashboard"}),(0,b.jsx)(D.DialogDescription,{className:"text-center",children:"Share this dashboard with stakeholders for read-only access to your OKR progress."})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-secondary/30 border border-border/50",children:[(0,b.jsx)(h.Label,{className:"text-sm font-medium mb-2 block",children:"Shareable Link"}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsx)(g.Input,{readOnly:!0,value:`/dashboard/shared/${Z()}`,className:"font-mono text-sm"}),(0,b.jsx)(f.Button,{size:"sm",variant:"outline",onClick:()=>{let a=`${window.location.origin}/dashboard/shared/${Z()}`;navigator.clipboard.writeText(a),u("Link copied to clipboard!")},children:(0,b.jsx)(L.Copy,{className:"w-4 h-4"})})]})]}),(0,b.jsxs)("div",{className:"p-4 rounded-lg bg-muted/50",children:[(0,b.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Access Details"}),(0,b.jsxs)("ul",{className:"space-y-2 text-sm text-muted-foreground",children:[(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(T.CheckCircle,{className:"w-4 h-4 mt-0.5 text-primary flex-shrink-0"}),(0,b.jsx)("span",{children:"Read-only access to all objectives and key results"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(T.CheckCircle,{className:"w-4 h-4 mt-0.5 text-primary flex-shrink-0"}),(0,b.jsx)("span",{children:"Real-time progress updates visible to viewers"})]}),(0,b.jsxs)("li",{className:"flex items-start gap-2",children:[(0,b.jsx)(T.CheckCircle,{className:"w-4 h-4 mt-0.5 text-primary flex-shrink-0"}),(0,b.jsx)("span",{children:"Link never expires and can be shared multiple times"})]})]})]})]}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>ad(!1),children:"Close"}),(0,b.jsxs)(f.Button,{onClick:()=>{let a=`${window.location.origin}/dashboard/shared/${Z()}`;navigator.clipboard.writeText(a),u("Link copied to clipboard!")},children:[(0,b.jsx)(L.Copy,{className:"w-4 h-4 mr-2"}),"Copy Link"]})]})]})})]})}var _=a.i(50429),aa=a.i(67900);let ab=(0,F.default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);function ac(){let a=(0,e.useRouter)(),[d,k]=(0,c.useState)(!0),[m,n]=(0,c.useState)(null),[o,p]=(0,c.useState)(null),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)(null),[u,v]=(0,c.useState)(""),[w,x]=(0,c.useState)("");(0,c.useEffect)(()=>{!async function(){try{let a=localStorage.getItem("userId");if(!a){p("Please log in to view your dashboard"),k(!1);return}let b=await fetch(`/api/okr/${a}`),c=await b.json();if(!b.ok||!c.success){p(c.error||"Failed to load your OKRs"),k(!1);return}let d={user:c.data.user,okr:{id:c.data.id,company_name:c.data.company_name,planning_period:c.data.planning_period,strategic_narrative:c.data.strategic_narrative,is_draft:c.data.is_draft,okrs:"string"==typeof c.data.okrs?JSON.parse(c.data.okrs):c.data.okrs}};n(d),k(!1)}catch(a){console.error("Error fetching dashboard data:",a),p("Failed to load dashboard. Please try again."),k(!1)}}()},[]);let y=a=>{let b=a.current_value??a.baseline_value,c=a.target_value;return 0===c?0:Math.min(Math.round(b/c*100),100)},z=a=>{let b=y(a);return b>=70?"on-track":b>=40?"at-risk":"off-track"},A=a=>a.key_results&&0!==a.key_results.length?Math.round(a.key_results.reduce((a,b)=>a+y(b),0)/a.key_results.length):0,B=async()=>{if(!s||!m)return;let a=[...m.okr.okrs];a[s.objectiveIndex].key_results[s.krIndex]={...s.kr,current_value:Number(u)},n({...m,okr:{...m.okr,okrs:a}}),r(!1)};if(d)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-accent/5",children:(0,b.jsx)(j.Card,{className:"w-full max-w-md border-border/50 bg-card/50 backdrop-blur",children:(0,b.jsx)(j.CardContent,{className:"flex items-center justify-center py-12",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)(S.Loader2,{className:"w-12 h-12 animate-spin text-primary mx-auto"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:"Loading your dashboard..."})]})})})});if(o||!m)return(0,b.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-destructive/5",children:(0,b.jsx)(j.Card,{className:"w-full max-w-md border-destructive/50 bg-card/50 backdrop-blur",children:(0,b.jsx)(j.CardContent,{className:"py-12",children:(0,b.jsxs)("div",{className:"text-center space-y-4",children:[(0,b.jsx)("div",{className:"mx-auto p-3 rounded-full bg-destructive/10 w-fit",children:(0,b.jsx)(_.Target,{className:"w-12 h-12 text-destructive"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Unable to Load Dashboard"}),(0,b.jsx)("p",{className:"text-muted-foreground",children:o||"Please check your invitation link."})]}),(0,b.jsxs)(f.Button,{variant:"outline",onClick:()=>{localStorage.removeItem("userId"),a.push("/")},children:[(0,b.jsx)(R.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Go Home"]})]})})})});let E=m?.okr.okrs&&0!==m.okr.okrs.length?Math.round(m.okr.okrs.reduce((a,b)=>a+A(b),0)/m.okr.okrs.length):0;return(0,b.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-accent/5 py-8 px-4",children:(0,b.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,b.jsxs)(j.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:[(0,b.jsx)(j.CardHeader,{children:(0,b.jsxs)("div",{className:"flex items-start justify-between",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(j.CardTitle,{className:"text-3xl",children:"My OKR Dashboard"}),(0,b.jsxs)(j.CardDescription,{className:"text-base",children:["Track your objectives and key results for ",m.okr.planning_period]})]}),m.okr.is_draft&&(0,b.jsx)(l.Badge,{variant:"outline",className:"text-accent border-accent/30",children:"Draft"})]})}),(0,b.jsx)(j.CardContent,{className:"space-y-4",children:(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,b.jsx)(ab,{className:"w-4 h-4 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Name"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:m.user.name})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,b.jsx)(_.Target,{className:"w-4 h-4 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Role"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:m.user.role})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,b.jsx)(aa.Building2,{className:"w-4 h-4 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Company"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:m.okr.company_name})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,b.jsx)(K.Calendar,{className:"w-4 h-4 text-primary"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"Period"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:m.okr.planning_period})]})]})]})})]}),(0,b.jsxs)(j.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:[(0,b.jsxs)(j.CardHeader,{children:[(0,b.jsx)(j.CardTitle,{className:"text-lg",children:"Strategic Context"}),(0,b.jsx)(j.CardDescription,{children:"How your work contributes to the overall strategy"})]}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-line leading-relaxed",children:m.okr.strategic_narrative})})]}),(0,b.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:(0,b.jsxs)(j.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Overall Progress"}),(0,b.jsxs)("p",{className:"text-3xl font-bold",children:[E,"%"]})]}),(0,b.jsx)("div",{className:"p-3 rounded-full bg-primary/10",children:(0,b.jsx)(G,{className:"w-6 h-6 text-primary"})})]}),(0,b.jsx)(C,{value:E,className:"mt-4"})]})}),(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:(0,b.jsxs)(j.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"Objectives"}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:m.okr.okrs.length})]}),(0,b.jsx)("div",{className:"p-3 rounded-full bg-accent/10",children:(0,b.jsx)(_.Target,{className:"w-6 h-6 text-accent"})})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-4",children:[m.okr.okrs.reduce((a,b)=>a+b.key_results.length,0)," key results"]})]})}),(0,b.jsx)(j.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:(0,b.jsxs)(j.CardContent,{className:"pt-6",children:[(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm text-muted-foreground",children:"On Track"}),(0,b.jsx)("p",{className:"text-3xl font-bold",children:m.okr.okrs.reduce((a,b)=>a+b.key_results.filter(a=>"on-track"===z(a)).length,0)})]}),(0,b.jsx)("div",{className:"p-3 rounded-full bg-accent/10",children:(0,b.jsx)(T.CheckCircle,{className:"w-6 h-6 text-accent"})})]}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground mt-4",children:[m.okr.okrs.reduce((a,b)=>a+b.key_results.filter(a=>"on-track"!==z(a)).length,0)," ","need attention"]})]})})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h2",{className:"text-xl font-semibold",children:"Your Objectives & Key Results"}),m.okr.okrs.map((a,c)=>(0,b.jsxs)(j.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:[(0,b.jsx)(j.CardHeader,{className:"pb-3",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsxs)(l.Badge,{variant:"secondary",children:["O",c+1]}),(0,b.jsxs)("div",{children:[(0,b.jsx)(j.CardTitle,{className:"text-lg",children:a.title}),a.description&&(0,b.jsx)(j.CardDescription,{className:"mt-1",children:a.description})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:[(0,b.jsxs)("span",{className:"text-sm text-muted-foreground",children:[A(a),"%"]}),(0,b.jsx)(C,{value:A(a),className:"w-24"})]})]})}),(0,b.jsx)(j.CardContent,{children:(0,b.jsx)("div",{className:"space-y-3",children:a.key_results.map((a,d)=>{let e=z(a),g=y(a),h=a.current_value??a.baseline_value;return(0,b.jsxs)("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-background/50 border border-border/50",children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground w-8",children:["KR",d+1]}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)("p",{className:"text-sm",children:a.title}),(0,b.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,b.jsxs)("span",{className:"text-xs text-muted-foreground",children:[h," / ",a.target_value," ",a.unit]}),(0,b.jsx)(C,{value:g,className:"w-32 h-1.5"})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",children:["on-track"===e&&(0,b.jsxs)(l.Badge,{variant:"outline",className:"text-accent border-accent/30 gap-1",children:[(0,b.jsx)(G,{className:"w-3 h-3"}),"On track"]}),"at-risk"===e&&(0,b.jsxs)(l.Badge,{variant:"outline",className:"text-chart-4 border-chart-4/30 gap-1",children:[(0,b.jsx)(I,{className:"w-3 h-3"}),"At risk"]}),"off-track"===e&&(0,b.jsxs)(l.Badge,{variant:"outline",className:"text-destructive border-destructive/30 gap-1",children:[(0,b.jsx)(H,{className:"w-3 h-3"}),"Off track"]}),(0,b.jsxs)(f.Button,{variant:"outline",size:"sm",onClick:()=>{t({objectiveIndex:c,krIndex:d,kr:a}),v(String(a.current_value??a.baseline_value)),x(""),r(!0)},children:[(0,b.jsx)(J.RefreshCw,{className:"w-3 h-3 mr-1"}),"Update"]})]})]},d)})})})]},c))]}),(0,b.jsx)(D.Dialog,{open:q,onOpenChange:r,children:(0,b.jsxs)(D.DialogContent,{children:[(0,b.jsxs)(D.DialogHeader,{children:[(0,b.jsx)(D.DialogTitle,{children:"Update Progress"}),(0,b.jsx)(D.DialogDescription,{children:s?.kr.title})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Current Value"}),(0,b.jsx)(g.Input,{type:"number",placeholder:"Enter current value",value:u,onChange:a=>v(a.target.value)}),(0,b.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Target: ",s?.kr.target_value," ",s?.kr.unit]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{children:"Notes (optional)"}),(0,b.jsx)(i.Textarea,{placeholder:"What progress was made?",value:w,onChange:a=>x(a.target.value),rows:3})]})]}),(0,b.jsxs)(D.DialogFooter,{children:[(0,b.jsx)(f.Button,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),(0,b.jsx)(f.Button,{onClick:B,disabled:!u,children:"Save Update"})]})]})})]})})}function ad(){let{leaderOKRs:a,currentUser:e}=(0,d.useOKR)(),[f,g]=(0,c.useState)(null);return((0,c.useEffect)(()=>{a.length>0?g(!0):g(!1)},[a]),null===f)?null:f?(0,b.jsx)("main",{className:"px-4 py-8",children:(0,b.jsx)($,{})}):(0,b.jsx)(ac,{})}a.s(["default",()=>ad],20731)}];

//# sourceMappingURL=app_dashboard_page_tsx_42ef5b16._.js.map