(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,20278,e=>{"use strict";let s=(0,e.i(75254).default)("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);e.s(["Target",()=>s],20278)},7486,e=>{"use strict";let s=(0,e.i(75254).default)("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);e.s(["Building2",()=>s],7486)},78928,e=>{"use strict";var s=e.i(43476),r=e.i(71645),a=e.i(18566),t=e.i(67881),l=e.i(70065),d=e.i(94179),c=e.i(87336),i=e.i(23750),n=e.i(10708),o=e.i(84762),x=e.i(30374),m=e.i(31278),u=e.i(20278),h=e.i(25652),j=e.i(35408),g=e.i(99023),p=e.i(87316),N=e.i(7486);let b=(0,e.i(75254).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var v=e.i(16715),k=e.i(69638),f=e.i(71689);function y(){let e=(0,a.useRouter)(),[y,C]=(0,r.useState)(!0),[w,_]=(0,r.useState)(null),[T,B]=(0,r.useState)(null),[D,M]=(0,r.useState)(!1),[S,O]=(0,r.useState)(null),[P,I]=(0,r.useState)(""),[R,U]=(0,r.useState)("");(0,r.useEffect)(()=>{!async function(){try{let e=localStorage.getItem("userId");if(!e){B("Please log in to view your dashboard"),C(!1);return}let s=await fetch(`/api/okr/${e}`),r=await s.json();if(!s.ok||!r.success){B(r.error||"Failed to load your OKRs"),C(!1);return}let a={user:r.data.user,okr:{id:r.data.id,company_name:r.data.company_name,planning_period:r.data.planning_period,strategic_narrative:r.data.strategic_narrative,is_draft:r.data.is_draft,okrs:"string"==typeof r.data.okrs?JSON.parse(r.data.okrs):r.data.okrs}};_(a),C(!1)}catch(e){console.error("Error fetching dashboard data:",e),B("Failed to load dashboard. Please try again."),C(!1)}}()},[]);let H=e=>{let s=e.current_value??e.baseline_value,r=e.target_value;return 0===r?0:Math.min(Math.round(s/r*100),100)},K=e=>{let s=H(e);return s>=70?"on-track":s>=40?"at-risk":"off-track"},L=e=>e.key_results&&0!==e.key_results.length?Math.round(e.key_results.reduce((e,s)=>e+H(s),0)/e.key_results.length):0,A=async()=>{if(!S||!w)return;let e=[...w.okr.okrs];e[S.objectiveIndex].key_results[S.krIndex]={...S.kr,current_value:Number(P)},_({...w,okr:{...w.okr,okrs:e}}),M(!1)};if(y)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-accent/5",children:(0,s.jsx)(l.Card,{className:"w-full max-w-md border-border/50 bg-card/50 backdrop-blur",children:(0,s.jsx)(l.CardContent,{className:"flex items-center justify-center py-12",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)(m.Loader2,{className:"w-12 h-12 animate-spin text-primary mx-auto"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"Loading your dashboard..."})]})})})});if(T||!w)return(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background via-background to-destructive/5",children:(0,s.jsx)(l.Card,{className:"w-full max-w-md border-destructive/50 bg-card/50 backdrop-blur",children:(0,s.jsx)(l.CardContent,{className:"py-12",children:(0,s.jsxs)("div",{className:"text-center space-y-4",children:[(0,s.jsx)("div",{className:"mx-auto p-3 rounded-full bg-destructive/10 w-fit",children:(0,s.jsx)(u.Target,{className:"w-12 h-12 text-destructive"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:"text-xl font-semibold mb-2",children:"Unable to Load Dashboard"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:T||"Please check your invitation link."})]}),(0,s.jsxs)(t.Button,{variant:"outline",onClick:()=>{localStorage.removeItem("userId"),e.push("/")},children:[(0,s.jsx)(f.ArrowLeft,{className:"w-4 h-4 mr-2"}),"Go Home"]})]})})})});let E=w?.okr.okrs&&0!==w.okr.okrs.length?Math.round(w.okr.okrs.reduce((e,s)=>e+L(s),0)/w.okr.okrs.length):0;return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-accent/5 py-8 px-4",children:(0,s.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,s.jsxs)(l.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:[(0,s.jsx)(l.CardHeader,{children:(0,s.jsxs)("div",{className:"flex items-start justify-between",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.CardTitle,{className:"text-3xl",children:"My OKR Dashboard"}),(0,s.jsxs)(l.CardDescription,{className:"text-base",children:["Track your objectives and key results for ",w.okr.planning_period]})]}),w.okr.is_draft&&(0,s.jsx)(d.Badge,{variant:"outline",className:"text-accent border-accent/30",children:"Draft"})]})}),(0,s.jsx)(l.CardContent,{className:"space-y-4",children:(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,s.jsx)(b,{className:"w-4 h-4 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Name"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:w.user.name})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,s.jsx)(u.Target,{className:"w-4 h-4 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Role"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:w.user.role})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,s.jsx)(N.Building2,{className:"w-4 h-4 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Company"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:w.okr.company_name})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"p-2 rounded-lg bg-primary/10",children:(0,s.jsx)(p.Calendar,{className:"w-4 h-4 text-primary"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"Period"}),(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:w.okr.planning_period})]})]})]})})]}),(0,s.jsxs)(l.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:[(0,s.jsxs)(l.CardHeader,{children:[(0,s.jsx)(l.CardTitle,{className:"text-lg",children:"Strategic Context"}),(0,s.jsx)(l.CardDescription,{children:"How your work contributes to the overall strategy"})]}),(0,s.jsx)(l.CardContent,{children:(0,s.jsx)("p",{className:"text-sm text-muted-foreground whitespace-pre-line leading-relaxed",children:w.okr.strategic_narrative})})]}),(0,s.jsxs)("div",{className:"grid gap-4 sm:grid-cols-3",children:[(0,s.jsx)(l.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:(0,s.jsxs)(l.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Overall Progress"}),(0,s.jsxs)("p",{className:"text-3xl font-bold",children:[E,"%"]})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-primary/10",children:(0,s.jsx)(h.TrendingUp,{className:"w-6 h-6 text-primary"})})]}),(0,s.jsx)(c.Progress,{value:E,className:"mt-4"})]})}),(0,s.jsx)(l.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:(0,s.jsxs)(l.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"Objectives"}),(0,s.jsx)("p",{className:"text-3xl font-bold",children:w.okr.okrs.length})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-accent/10",children:(0,s.jsx)(u.Target,{className:"w-6 h-6 text-accent"})})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-4",children:[w.okr.okrs.reduce((e,s)=>e+s.key_results.length,0)," key results"]})]})}),(0,s.jsx)(l.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:(0,s.jsxs)(l.CardContent,{className:"pt-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-muted-foreground",children:"On Track"}),(0,s.jsx)("p",{className:"text-3xl font-bold",children:w.okr.okrs.reduce((e,s)=>e+s.key_results.filter(e=>"on-track"===K(e)).length,0)})]}),(0,s.jsx)("div",{className:"p-3 rounded-full bg-accent/10",children:(0,s.jsx)(k.CheckCircle,{className:"w-6 h-6 text-accent"})})]}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground mt-4",children:[w.okr.okrs.reduce((e,s)=>e+s.key_results.filter(e=>"on-track"!==K(e)).length,0)," ","need attention"]})]})})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-xl font-semibold",children:"Your Objectives & Key Results"}),w.okr.okrs.map((e,r)=>(0,s.jsxs)(l.Card,{className:"border-border/50 bg-card/50 backdrop-blur",children:[(0,s.jsx)(l.CardHeader,{className:"pb-3",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)(d.Badge,{variant:"secondary",children:["O",r+1]}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.CardTitle,{className:"text-lg",children:e.title}),e.description&&(0,s.jsx)(l.CardDescription,{className:"mt-1",children:e.description})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("span",{className:"text-sm text-muted-foreground",children:[L(e),"%"]}),(0,s.jsx)(c.Progress,{value:L(e),className:"w-24"})]})]})}),(0,s.jsx)(l.CardContent,{children:(0,s.jsx)("div",{className:"space-y-3",children:e.key_results.map((e,a)=>{let l=K(e),i=H(e),n=e.current_value??e.baseline_value;return(0,s.jsxs)("div",{className:"flex items-center gap-4 p-3 rounded-lg bg-background/50 border border-border/50",children:[(0,s.jsxs)("span",{className:"text-xs text-muted-foreground w-8",children:["KR",a+1]}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("p",{className:"text-sm",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center gap-4 mt-1",children:[(0,s.jsxs)("span",{className:"text-xs text-muted-foreground",children:[n," / ",e.target_value," ",e.unit]}),(0,s.jsx)(c.Progress,{value:i,className:"w-32 h-1.5"})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:["on-track"===l&&(0,s.jsxs)(d.Badge,{variant:"outline",className:"text-accent border-accent/30 gap-1",children:[(0,s.jsx)(h.TrendingUp,{className:"w-3 h-3"}),"On track"]}),"at-risk"===l&&(0,s.jsxs)(d.Badge,{variant:"outline",className:"text-chart-4 border-chart-4/30 gap-1",children:[(0,s.jsx)(g.Minus,{className:"w-3 h-3"}),"At risk"]}),"off-track"===l&&(0,s.jsxs)(d.Badge,{variant:"outline",className:"text-destructive border-destructive/30 gap-1",children:[(0,s.jsx)(j.TrendingDown,{className:"w-3 h-3"}),"Off track"]}),(0,s.jsxs)(t.Button,{variant:"outline",size:"sm",onClick:()=>{O({objectiveIndex:r,krIndex:a,kr:e}),I(String(e.current_value??e.baseline_value)),U(""),M(!0)},children:[(0,s.jsx)(v.RefreshCw,{className:"w-3 h-3 mr-1"}),"Update"]})]})]},a)})})})]},r))]}),(0,s.jsx)(x.Dialog,{open:D,onOpenChange:M,children:(0,s.jsxs)(x.DialogContent,{children:[(0,s.jsxs)(x.DialogHeader,{children:[(0,s.jsx)(x.DialogTitle,{children:"Update Progress"}),(0,s.jsx)(x.DialogDescription,{children:S?.kr.title})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"Current Value"}),(0,s.jsx)(i.Input,{type:"number",placeholder:"Enter current value",value:P,onChange:e=>I(e.target.value)}),(0,s.jsxs)("p",{className:"text-xs text-muted-foreground",children:["Target: ",S?.kr.target_value," ",S?.kr.unit]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{children:"Notes (optional)"}),(0,s.jsx)(o.Textarea,{placeholder:"What progress was made?",value:R,onChange:e=>U(e.target.value),rows:3})]})]}),(0,s.jsxs)(x.DialogFooter,{children:[(0,s.jsx)(t.Button,{variant:"outline",onClick:()=>M(!1),children:"Cancel"}),(0,s.jsx)(t.Button,{onClick:A,disabled:!P,children:"Save Update"})]})]})})]})})}e.s(["default",()=>y],78928)}]);